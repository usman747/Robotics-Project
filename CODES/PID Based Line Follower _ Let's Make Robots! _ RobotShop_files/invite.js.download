var startX=0;var startY=200;var closeX=15;var closeY=15;var invType=0;var paramData;var closeToolTip;var playSound='';var leaveOnScreen=0;var inviteFade=0;var fadeInterval=0;var locX=startX;var locY=startY;var imgW=0;var maxX=0;var maxY=0;var getC=0;var hldX=0;var incSpeed=2;var timeInterval=39;var incX=incSpeed;var incY=0;var cStat=1;var mvTimer=0;var mvInterval=0;var imageOpacity=1;imgPoll=new Image();imgPoll.onload=chkImg;if(typeof(sWOSession)=="undefined"){var sWOCookie=document.cookie.toString();if(sWOCookie.indexOf('whoson')==-1){sWOSession=""}else{var s=sWOCookie.indexOf("whoson=")+7;var e=sWOCookie.indexOf(";",s);if(e==-1){e=sWOCookie.length;sWOSession=sWOCookie.substring(s,e)}}}function woAfterLoad(){var tmpDiv=document.createElement('DIV');tmpDiv.setAttribute('name','woInvite');tmpDiv.setAttribute('id','woInvite');tmpDiv.setAttribute('align','right');tmpDiv.style.position='absolute';tmpDiv.style.top=startY;tmpDiv.style.left=startX;tmpDiv.style.zIndex=999;document.body.appendChild(tmpDiv);function getImg(){var rTimer=6000;var pUrl="http://whoson.robotshop.com:8080/poll.gif?d=www.robotshop.com/letsmakerobots&stamp="+(new Date()).getTime();if(typeof(sWOSession)!="undefined"){pUrl+="&u="+sWOSession}imgPoll.src=pUrl;getC++;if(getC>184){return}if(getC>10){rTimer=10000}if(rTimer>0){setTimeout(getImg,rTimer)}}setTimeout(getImg,1000)}function stopMove(){hldX=2;if(leaveOnScreen===0){if(inviteFade==1){setInterval(fadeOutStep,200)}setTimeout(stopInvite,4000)}}function woMove(){if(hldX===0){locX=locX+incX;locY=locY+incY;if(locX<=0){if(invType===0||invType==4){stopMove()}else if(invType==1){incX=0-incX;locX=0}}else if(locX>=maxX){if(invType===0||invType==4){incX=0-incX;locX=maxX}else if(invType==1){stopMove()}}if(locY<=0){if(invType==3||invType==4){incY=0-incY;locY=0}else if(invType==2){stopMove()}}else if(locY>=maxY){if(invType==2||invType==4){incY=0-incY;locY=maxY}else if(invType==3){stopMove()}}woDIVs.left=(locX+'px');woDIVs.top=(locY+'px');mvInterval=setTimeout(woMove,timeInterval)}else{mvInterval=setTimeout(woMove,timeInterval*10)}}function startMove(){mvInterval=setTimeout(woMove,timeInterval)}function setDefaults(){startX=0;startY=200;closeX=15;closeY=15;invType=0;playSound='';leaveOnScreen=0;inviteFade=0}function chkImg(){if(imgPoll!=null){nStat=imgPoll.width;if(cStat>1&&nStat>1){stopInvite()}if(cStat!=nStat){cStat=nStat;if(cStat==3)getParams();if(cStat==2){setDefaults();startInvite()}}}}imgPoll=new Image();imgPoll.onload=chkImg;function getIImgw(){imgW=woIMG.width;maxX=f_clientWidth()-imgW;if(locX>maxX){locX=maxX}maxY=f_clientHeight()-woIMG.height;if(locY>maxY){locY=maxY}woDIVs.left=locX+'px';woDIVs.top=locY+'px';if(playSound!=''){inviteSound()}if(inviteFade==1){fadeInvite()}else{woDIVs.opacity=1;woDIVs.filter="alpha(opacity=100)"}}function inviteSound(){var t=null;if(typeof navigator.mimeTypes['audio/wav']=='object'){t=document.createElement('embed');t.autostart=1;t.playcount=1;t.width=0;t.height=0;if(navigator.mimeTypes["application/x-mplayer2"].enabledPlugin!=null){t.type="application/x-mplayer2"}else if(navigator.mimeTypes["audio/wav"].enabledPlugin!=null){t.type="audio/wav"}}else{t=document.createElement('bgsound');t.loop=0}if(t!=null){t.src="http://whoson.robotshop.com:8080/"+playSound+"?domain=www.robotshop.com/letsmakerobots";document.body.appendChild(t)}}function startInvite(){if(invType===0){incX=incSpeed;incY=0}else if(invType==1){incX=0-incSpeed;incY=0}else if(invType==2){incX=0;incY=incSpeed}else if(invType==3){incX=0;incY=0-incSpeed}else if(invType==4){incX=incSpeed;incY=incSpeed}else if(invType==5){incX=0;incY=0;hldX=2}var ofsY;var iUrl="http://whoson.robotshop.com:8080/invite.gif?d=www.robotshop.com/letsmakerobots&stamp="+(new Date()).getTime();if(typeof(sWOSession)!="undefined")iUrl+="&u="+sWOSession;if(document.documentElement&&document.documentElement.scrollTop){ofsY=document.documentElement.scrollTop}else{ofsY=document.body.scrollTop}hldX=0;locX=startX;locY=startY;woDIVs=document.getElementById('woInvite').style;woDIVh=document.getElementById('woInvite');imageOpacity=0;woDIVs.opacity=0;woDIVs.filter="alpha(opacity=0)";woDIVh.innerHTML='<a href="javascript:void(0);" onclick="return startChat(event);" onMouseOver="anPause()" onMouseOut="anResume()"><img border="0" src='+iUrl+' name="woIImg"</a>';woDIVs.top='0px';woDIVs.left='0px';if(invType==5){setTimeout(stopMove,45000)}else{mvTimer=setTimeout(startMove,3000)}woIMG=document.images.woIImg;woIMG.onload=getIImgw}function fadeInvite(){fadeInterval=setInterval(fadeInStep,200)}function fadeInStep(){imageOpacity=imageOpacity+0.05;woDIVs.opacity=imageOpacity;woDIVs.filter="alpha(opacity="+(imageOpacity*100)+")";if(imageOpacity>=1){clearTimeout(fadeInterval)}}function fadeOutStep(){imageOpacity=imageOpacity-0.05;woDIVs.opacity=imageOpacity;woDIVs.filter="alpha(opacity="+(imageOpacity*100)+")";if(imageOpacity<=0){clearTimeout(fadeInterval)}}function stopInvite(){cStat=1;woDIVh.innerHTML="";if(mvTimer>0){clearTimeout(mvTimer)}if(mvInterval>0){clearTimeout(mvInterval);if(fadeInterval>0){clearInterval(fadeInterval)}}}function startChat(event){if(event.clientX<locX+imgW-closeX||event.clientY>locY+closeY){this.chatWindow=window.open("http://whoson.robotshop.com/chat/chatstart.htm?domain=www.robotshop.com/letsmakerobots","Chat","width=484,height=361");this.chatWindow.focus();this.chatWindow.opener=window}stopInvite()}function anPause(){if(hldX===0){hldX=1}}function anResume(){if(hldX==1){hldX=0}}function getParams(){var ifme=document.createElement("script");ifme.type="text/javascript";ifme.language="Javascript";ifme.src="http://whoson.robotshop.com:8080/params.js?d=www.robotshop.com/letsmakerobots&stamp="+(new Date()).getTime()+((typeof sWOSession!="undefined")?"&u="+sWOSession:"");document.body.appendChild(ifme)}function invJSLoaded(){parseParams();startInvite()}function parseParams(){invType=parseInt(parseParam('type','0'));startX=parseInt(parseParam('startX','0'));startY=parseInt(parseParam('startY','30'));closeX=parseInt(parseParam('closeX','5'));closeY=parseInt(parseParam('closeY','5'));closeToolTip=parseParam('closetip','Close');playSound=parseParam('sound','');leaveOnScreen=(parseParam('leave','N')=='Y'?1:0);inviteFade=(parseParam('fade','N')=='Y'?1:0)}function parseParam(paramName,defVal){if(paramData.indexOf(paramName+"=")>=0){var pdata=paramData.split(paramName+"=");if(pdata.length==1){return def}else{return pdata[1].split(";")[0]}}}var woOldOnload=window.onload;if(typeof woOldOnload=='function'){if(!(String(woOldOnload).indexOf('woAfterLoad')>0)){var woRunOnload=woOldOnload;window.onload=function(){woRunOnload();woAfterLoad()}}}else{window.onload=woAfterLoad}function f_clientWidth(){return f_filterResults(window.innerWidth?window.innerWidth:0,0,document.body?document.body.clientWidth:0)}function f_clientHeight(){return f_filterResults(window.innerHeight?window.innerHeight:0,document.documentElement.clientHeight?document.documentElement.clientHeight:0,document.body?document.body.clientHeight:0)}function f_filterResults(n_win,n_docel,n_body){var n_result=n_win?n_win:0;if(n_docel&&(!n_result||(n_result>n_docel)))n_result=n_docel;return n_body&&(!n_result||(n_result>n_body))?n_body:n_result}
